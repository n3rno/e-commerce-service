<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.hhplus.be.server.point.infrastructure.persistence.mapper.PointMapper">

    <!-- 유저의 포인트 잔액 확인 -->
    <select id="selectBalanceByUserNo" parameterType="int" resultType="kr.hhplus.be.server.point.domain.model.PointBalance">
        SELECT balance, user_no FROM point_hist WHERE user_no = #{userNo} ORDER BY CREATED_AT DESC LIMIT 1
    </select>

    <!-- 포인트 충전(사용) 이력 데이터 삽입 -->
    <insert id="insertPointHist" parameterType="kr.hhplus.be.server.point.domain.model.Point">
        INSERT INTO point_hist (
            type,
            amount,
            order_id,
            balance,
            user_no,
            created_at
        ) VALUES (
            #{type},
            #{amount},
            #{orderId},
            #{balance},
            #{userNo},
            NOW()
        )
    </insert>

</mapper>
